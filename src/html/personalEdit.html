<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- QQ强制竖屏 -->
    <meta name="x5-orientation" content="portrait">
    <!-- UC强制全屏 -->
    <meta name="full-screen" content="yes">
    <!-- QQ强制全屏 -->
    <meta name="x5-fullscreen" content="true">
    <!-- UC应用模式 -->
    <meta name="browsermode" content="application">
    <!-- QQ应用模式 -->
    <meta name="x5-page-mode" content="app">
    <!-- windows phone 点击无高光 -->
    <meta name="msapplication-tap-highlight" content="no">
    <title>编辑信息</title>
    <link rel="stylesheet" href="../css/normalize.css">
    <link type="text/css" rel="stylesheet" href="../css/swiper.css" />
    <link type="text/css" rel="stylesheet" href="../css/sweetalert.css" />
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/index.css">
</head>
<body>
<div class="shopping_header">
    <p class="title">编辑信息</p>

</div>
<div class="personal_edit_body">
    <div class="info_title">
        <img src="../images/personal/user_103.png" alt="">
        基础信息
    </div>
    <div class="info_item" onclick="location='changeName.html'">
        姓名
        <span class="to_edit">
            <img src="../images/personal/home_57@2x.png" alt="">
        </span>
        <span id="user_name"></span>
    </div>
    <div class="info_title">
        <img src="../images/personal/user_100.png" alt="">
        账号信息
    </div>
    <div class="info_item">
        修改密码
        <span class="to_edit">
            <img src="../images/personal/home_57@2x.png" alt="" onclick="location='password.html'">
        </span>

    </div>
    <div class="info_item">
        更换手机号码
        <span class="to_edit" onclick="location='changePhone.html'">
            <img src="../images/personal/home_57@2x.png" alt="">
        </span>
        <span class="default_info"> </span>
    </div>
</div>
<div class="footer">
    <ul class="nav">
        <li>
            <a href="index.html">
                <img src="../images/tab/tab_32.png" alt="">
                首页
            </a>
        </li>
        <li>
            <a href="store.html">
                <img src="../images/tab/tab_36.png" alt="">
                精品商城
            </a>
        </li>
        <li>
            <a href="">
                <img src="../images/tab/tab_38.png" alt="">
                我的药箱
            </a>
        </li>
        <li>
            <a href="personal.html">
                <img src="../images/tab/tab_40.png" alt="">
                个人中心
            </a>
        </li>
    </ul>
</div>
</body>
<script type="text/template" id="name_template">
    <span class="default_info"><%= personal.name %></span>
</script>
<script src="../javascript/jquery-3.2.1.min.js"></script>
<script src="../javascript/sweetalert.min.js"></script>
<script src="../javascript/underscore-1.8.3.min.js"></script>
<script src="../javascript/util.js"></script>
<script>
    get_personal(window.localStorage.getItem('userId'));
    function get_personal(id) {
        $.ajax({
            url:"/user",
            data:{"userID":id},
            headers: {"X-Requested-With": "h5"},
            success:function(json) {
                if (json && json.error) {
                    swal("", json.error.message);
                } else {
                    var name_template = _.template($("#name_template").html());
                    $("#user_name").html(name_template({"personal": json.success}));
                }
            },
            error:function (xhr, status, message) {
                if(message === "Unauthorized") {
                    window.location.href = "login.html";
                }else {
                    swal("", "系统繁忙，请稍后再试。");
                }
            }
        });
    }
</script>
</html>