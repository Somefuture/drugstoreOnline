<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
		<title></title>
		<link rel="stylesheet" type="text/css" href="../css/login.css"/>
		<link rel="stylesheet" type="text/css" href="../css/sweetalert.css"/>
	</head>
	<body>
		<div class="lo-img">
			<img src="../images/imgs/logo.png" />
		</div>
		<div class="lo-ipt-box" id="user_form">
			<div class="lo-ipt div-flex">
				<img src="../images/imgs/user.png" />
				<input type="text" id="username" placeholder="用户名"/>
			</div>
			<div class="lo-ipt div-flex">
				<img src="../images/imgs/pwd.png" />
				<input type="password" id="password" placeholder="密码"/>
			</div>
			<button id="login">登 录</button>
			<div class="lo-more div-flex">
				<div class="one-flex align-l">
					<a href="register.html">
						<span>注册新用户</span>
					</a>
				</div>
				<div class="one-flex align-r">
					<a href="password.html">
						<span>忘记密码？</span>
					</a>
				</div>
			</div>
		</div>
		<!--<div class="lo-foot">-->
		<!--<div class="po-r lo-third">使用第三方快速登录</div>-->
		<!--<div class="div-flex">-->
		<!--<div class="one-flex"><img src="../images/imgs/lo-qq.png" /></div>-->
		<!--<div class="one-flex align-c"><img src="../images/imgs/lo-wx.png" /></div>-->
		<!--<div class="one-flex align-r"><img src="../images/imgs/lo-xlwb.png" /></div>-->
		<!--</div>-->
		<!--</div>-->
		<script src="../javascript/jquery-3.2.1.min.js"></script>
		<script src="../javascript/sweetalert.min.js"></script>
		<script>
			var show_swal = false;
            function login() {
                const username = $("#username").val();
                const password = $("#password").val();
                if (!username) {
                    show_swal = true;
                    swal("请输入手机号码");
                } else if (!password) {
                    show_swal = true;
                    swal("请输入登录密码");
                } else {
                    $.ajax({
                        type: "post",
                        url: "/account/mobile/signin",
                        data: {"mobile": username, "password": password},
                        headers: {"X-Requested-With": "test"},
                        success: function (json) {
                            if(json && json.error) {
                                show_swal = true;
                                swal("登录失败", json.error.message);
                            }else {
                                window.location.href = "index.html";
                            }
                        },
                        error: function () {
                            show_swal = true;
                            swal("系统繁忙，请稍后再试。");
                        }
                    });
                }
            }

            $("#login").click(login);

            $("#user_form").keyup(function (e) {
                if(Number(e.keyCode) === 13) {
                    if(show_swal) {
                        show_swal = false;
					}else {
                        login();
					}
				}
            })
		</script>

	</body>
</html>
